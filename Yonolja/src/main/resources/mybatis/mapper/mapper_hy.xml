<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
	PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
	
<mapper namespace="com.human.springboot.DAO_HY">
<!-- host_addPlace show select option 관련  -->
	<select id="showPtype" resultType="com.human.springboot.DTO_HY_P">
		select place_type_seq, place_type_name from yonolja_place_type 
	</select>
	
	<select id="showPoption" resultType="com.human.springboot.DTO_HY_P">
    	select place_option_seq, place_option_name from yonolja_place_option order by place_option_seq asc
	</select>


<!-- host_addPlace DB insert 관련  -->

	<insert id="addplace">
		insert into yonolja_place values(
			place_seq.nextval,#{param1}
			,#{param2},#{param3},#{param4},#{param5},#{param6},#{param7},#{param8},#{param9},#{param10}
		) 
<!-- 		place opt관련 param 한개 삭제   -->
	</insert>
	

	
	<select id="getEnvironments"  resultType="com.human.springboot.DTO_HY_P">
		select*from yonolja_place_environment
	</select>
	

<!-- place option이 아니고 roomtype_option 가져와야함  -->
	
	<select id="getPlace" resultType="com.human.springboot.DTO_HY_placeDTO">
		select * from yonolja_place where place_seq = #{param1}
	</select>
	
<!-- 	업장정보수정모달관련코드 -->
	<update id="changePlace">
    UPDATE yonolja_place SET
        place_name = #{param2},
        user_seq = #{param3},
        place_type_seq = #{param4},
        place_checkin_time = #{param5},
        place_checkout_time = #{param6},
        place_address = #{param7},
        place_mobile = #{param8},
<!--         place_options = #{param9}, -->
        place_guide = #{param9},
        place_environment = #{param10}
    WHERE place_seq = #{param1}
	</update>
	
<!-- 객실타입추가 part -->
		<insert id="addRoomType">
			    insert into yonolja_roomtype (
			        ROOMTYPE_SEQ,
			        ROOMTYPE_NAME,
			        PLACE_SEQ,
			        ROOMTYPE_IMGS, 
			        ROOMTYPE_CAPACITY,
			        ROOMTYPE_PRICE,
			        ROOMTYPE_GUIDE
			    )
			 
			     values(
			        roomtype_seq.nextval,
			        #{param1},
			        #{param2},
			     	#{param3},
			        #{param4},
			  		#{param5},
			  		#{param6}
			    )
		</insert>
			
	
	
<!-- 객실타입 사진관련 코드 -->

 
		
		<select id="getImgAddress" resultType="Object">
			select roomtype_imgs from yonolja_roomtype 
			where roomtype_seq = #{param1}
		</select>
		
		<update id="updateImg">
			update yonolja_roomtype set roomtype_imgs=#{param1} where roomtype_seq=#{param2}
		</update>

	
	


    <select id="getRoomtype" resultType="com.human.springboot.DTO_HY_roomtypeDTO">
        SELECT * FROM yonolja_roomtype
        where place_seq = #{param1}
    </select>
    
    
<!--     Roomtype update 코드 PART -->

	<update id="modifyRoomtype">
    	UPDATE yonolja_roomtype SET
	        roomtype_name = #{param2},
	        place_seq = #{param3},
	        roomtype_imgs = #{param4},
	        roomtype_capacity = #{param5},
	        roomtype_price = #{param6},
	        roomtype_guide = #{param7}
   		 WHERE roomtype_seq= #{param1}
	 </update>
 
	
<!-- 	 Roomtype delete PART -->
		 <delete id="deleteRoomtype" >
    		DELETE FROM yonolja_roomtype 
    		WHERE roomtype_seq = #{param1}
  		</delete>
  		
<!--   	 Room insert Part -->


	<insert id="addRoom">
		insert into yonolja_room values(
			room_seq.nextval,
			 #{param1},
			 #{param2}
		)
	</insert>
	
	
<!-- 	room select part -->

	<select id="showRooms" resultType="com.human.springboot.DTO_HY_roomtypeDTO">
    	select r.room_number, t.roomtype_name, r.room_seq 
<!--     	r.room_seq 추가//////////////////////////////////////////////// -->
    	from yonolja_room r,
    		 yonolja_roomtype t
    	where t.roomtype_seq=#{param1}
    	and r.roomtype_seq=t.roomtype_seq
    	order by r.room_number asc
	</select>
	

<!-- room num Delete part -->
 		<delete id="deleteRoomNum" >
    		DELETE FROM yonolja_room 
    		WHERE room_seq = #{param1}
  		</delete>
  		
  		
<!--   		room insert 시 동일객실존재하는지 체크 part -->

	<select id="checkRoomExists" resultType="java.lang.Integer">

		    SELECT COUNT(*)
		    FROM yonolja_roomtype a, yonolja_room b
		    WHERE a.roomtype_seq = b.roomtype_seq
		      AND a.place_seq = #{param1}
		      AND b.room_number = #{param2}
		    GROUP BY a.place_seq, b.room_number
		    HAVING COUNT(*) >= 1
	</select>

		



		
<!-- place Delete part -->

		<delete id="deletePlace" >
    		DELETE FROM yonolja_place
    		WHERE place_seq = #{param1}
  		</delete>
		


</mapper>




