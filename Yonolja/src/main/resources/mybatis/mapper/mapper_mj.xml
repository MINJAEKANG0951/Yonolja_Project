<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
	PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
	
<mapper namespace="com.human.springboot.DAO_MJ">
	
	<select id="getNormalUsers" resultType="com.human.springboot.DTO_MJ_userDTO">
		select*from yonolja_user where user_signinType='normal'
	</select>
	
	<insert id="addUser">
		insert into yonolja_user values(
			user_seq.nextval, 
			#{param1},#{param2},#{param3},#{param4},#{param5},#{param6},#{param7},#{param8} 
		)
	</insert>
	
	<select id="getPlaceOptions" resultType="com.human.springboot.DTO_MJ_placeOptionDTO">
		select*from yonolja_place_option
	</select>
	
	<select id="getPlaceTypes" resultType="com.human.springboot.DTO_MJ_placeTypeDTO">
		select*from yonolja_place_type
	</select>
	
	<select id="getPlaceEnvironments" resultType="com.human.springboot.DTO_MJ_placeEnvironmentDTO">
		select*from yonolja_place_environment 
	</select>
	 
	<select id="getPlaces" resultType="com.human.springboot.DTO_MJ_placeDTO_forMain">
		select place_seq, place_name, place_address, place_imgs , min(roomtype_price) as roomtype_price
		from
			    (select p.place_seq, p.place_name, p.place_address ,p.place_imgs, p.place_environment, rt.roomtype_name, rt.roomtype_price, rt.roomtype_capacity, rt.roomtype_options
			    from yonolja_room rm, yonolja_roomtype rt, yonolja_place p
			    where rm.roomtype_seq = rt.roomtype_seq and rt.place_seq = p.place_seq
			    ${param1}  
			    )
		group by  place_seq, place_name, place_address, place_imgs, place_environment
	</select>
	
	<select id="getReviewRate" resultType="float">
		select nvl(avg(review_star),0)
		from yonolja_review review, yonolja_book book,yonolja_room room, yonolja_roomtype type, yonolja_place place
		where 
	    review.book_seq = book.book_seq and book.room_seq = room.room_seq and room.roomtype_seq = type.roomtype_seq and 
	    type.place_seq = place.place_seq and place.place_seq=#{param1}
	</select>
	
	
	
	<select id="getPlace" resultType="com.human.springboot.DTO_MJ_placeDTO">
		select*from yonolja_place where place_seq = #{param1}
	</select>
	
	
</mapper>

