<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
	PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
	
<mapper namespace="com.human.springboot.DAO_HS">
	<!-- 마이페이지 -->
	<select id="host_imgs" resultType="com.human.springboot.DTO_HS_userDTO">
		select a.user_seq, a.user_id, b.place_imgs, b.place_seq, a.user_type, b.place_name
		from yonolja_user a, yonolja_place b where a.user_seq = b.user_seq
		order by b.place_seq
	</select>
	
	<select id="user_all" resultType="com.human.springboot.DTO_HS_userDTO">
		SELECT user_seq, user_id, user_password, user_name, user_mobile, user_email, user_gender, user_type, user_signinType
		FROM yonolja_user
		WHERE user_seq = #{param1}
	</select>	
	
	<!-- 내정보관리 -->
	<update id="updateUserNolja">
		update yonolja_user set user_email=#{param2}, user_password=#{param3}, user_mobile=#{param4}
		where user_seq=#{param1}
	</update>
	
	<delete id="YonoljaBye">
		delete from yonolja_user where user_seq=#{param1}
	</delete>
	
	<!-- 나의문의 -->
	<select id="myPostlist" resultType="com.human.springboot.DTO_HS_postDTO">
	    select b.post_seq, b.post_title, b.post_date, b.post_comment
	    from yonolja_user a, yonolja_post b 
	    where a.user_seq = b.user_seq and b.user_seq = #{param1}
	    order by b.post_seq
	</select>
	
	<!-- 예약내역 -->
  	<select id="myBooklist" resultType="com.human.springboot.DTO_HS_bookDTO">
		select a.book_seq, a.user_seq, a.room_seq, a.checkin_date, a.checkout_date, a.book_price, c.roomtype_name, d.place_name
		from yonolja_book a, yonolja_room b, yonolja_roomtype c, yonolja_place d
		where a.room_seq = b.room_seq 
		and b.roomtype_seq = c.roomtype_seq
		and c.place_seq = d.place_seq
		and a.user_seq = #{param1}
   order by a.checkin_date DESC
	</select>
	
	<!-- 예약내역에서 리뷰 등록하기 -->
 	<insert id="review_insert">
		insert into yonolja_review values(review_seq.nextval, #{param1}, sysdate, #{param2}, #{param3})
	</insert> 
	
	<!-- 나의후기에서 리뷰 조회(출력)하기 -->
	<select id="myReviewlist" resultType="com.human.springboot.DTO_HS_reviewDTO">
		select a.review_seq, b.user_seq, e.place_name, b.checkin_date, a.review_content, a.review_date, e.place_seq, a.review_star
		  from yonolja_review a, yonolja_book b, yonolja_room c, yonolja_roomtype d, yonolja_place e
		 where a.book_seq=  b.book_seq
		   and b.room_seq = c.room_seq
		   and c.roomtype_seq = d.roomtype_seq
		   and d.place_seq = e.place_seq
		   and b.user_seq = #{param1}
	  order by b.checkin_date DESC
	</select>
	
	<!-- 나의후기에서 리뷰 수정(업데이트)하기 -->
	<update id="myreview_update">
		update yonolja_review set review_content = #{param2}, review_star = #{param3}
		where review_seq = #{param1}
	</update>
	
	<!-- 나의후기에서 리뷰 삭제하기 -->
	<delete id="myReview_delete">
		delete from yonolja_review where review_seq = #{param1}
	</delete>
	
	
</mapper>

